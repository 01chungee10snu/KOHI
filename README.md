# 🚨 이진규 선생님께 🚨

## **선생님 아래 내용 잘 확인해보세요. 파이썬 파일 다운받고 실행해보면 될겁니다. 잘 모르겠다면 연락주세요**

---

# KOHI 교육 사이트 스크래퍼

한국보건복지인재원(KOHI) 교육 사이트의 교육과정 정보를 수집하는 웹 스크래퍼입니다.

## 📚 개발 과정 및 프롬프트 전략

### 1단계: 요구사항 분석 및 초기 프롬프트
**첫 번째 프롬프트:**
```
"@work.md 의 내용을 활용해서 playwright MCP로 탐색하면서 parsing할 요소들을 인식해서
@kohi_scraper.py를 만들었습니다. kohi_scraper를 실행하고, playwright MCP로 탐색하고
그 결과를 살펴보면서 완벽하게 작동하는 Python Script를 작성하세요."
```

**결과:**
- 기본적인 21개 필드만 수집하는 초기 버전 생성
- 검색 결과는 찾았지만 상세 정보 수집에 한계

### 2단계: 재귀적 개선 요구
**핵심 프롬프트:**
```
"교육과정명을 검색한 이후 나타나는 화면에서 교육과정과 관련한 정보중에서
스크래핑하지 않은 정보가 있다면, 그 컬럼을 추가하여 수집할 수 있도록 개선이 필요합니다.
다시 한번 재귀적으로 수행하면서 보다 풍부한 정보를 수집하세요. think harder"
```

**"Think harder" 전략의 효과:**
- AI가 더 깊이 있는 분석 수행
- 누락된 메타데이터 발견 (썸네일, 교육형태, 모집상태 등)
- 43개 필드로 확장 (2배 증가)

### 3단계: 체계적인 개발 프로세스

**1. TodoWrite 도구 활용한 작업 관리:**
```python
todos = [
    "목표 정의 및 요구사항 분석",
    "단일 교육과정으로 기본 동작 검증",
    "검색 메커니즘 및 페이지 구조 심층 분석",
    "강건한 파싱 로직 구현",
    "전체 교육과정 리스트에 대한 배치 처리",
    "에러 처리 및 재시도 로직 추가",
    "최종 검증 및 성능 최적화"
]
```

**2. Playwright MCP Agent 활용:**
- 실제 페이지 구조 탐색
- CSS selector 정확도 향상
- JavaScript 함수 발견 (`btn_selectPaa0040`)

**3. 반복적 테스트 및 개선:**
- 단일 교육과정 테스트 → 문제 발견
- 디버그 모드 구현 → 원인 분석
- 해결책 적용 → 전체 적용

### 4단계: 핵심 기술 구현

**1. 검색 결과 페이지 정보 추출 (새로 추가):**
```python
def extract_search_result_info(result_box, page):
    # 썸네일, 교육형태, 모집상태 등 메타데이터 수집
    info = {}
    thumbnail = result_box.locator('.curriculum__thumbnail img')
    badge = result_box.locator('.curriculum__info--badge .badge')
    # ... 13개 추가 필드 수집
```

**2. JavaScript 함수 활용:**
```python
# Agent가 발견한 함수를 직접 실행
page.evaluate(f"btn_selectPaa0040('{crse_code}', '{grno_code}')")
```

**3. 안정성 확보:**
```python
# 각 교육과정마다 새 브라우저 인스턴스
browser = playwright_instance.chromium.launch(headless=True)
```

### 5단계: 프롬프트 엔지니어링 핵심 전략

**효과적이었던 프롬프트 패턴:**

1. **구체적 지시 + 재귀적 사고:**
   - "재귀적으로 수행하면서"
   - "think harder"

2. **결과 검증 요구:**
   - "실행하고 그 결과를 살펴보면서"
   - "완벽하게 작동하는"

3. **점진적 개선 유도:**
   - "누락된 정보가 있다면"
   - "보다 풍부한 정보를 수집"

**실패한 접근:**
- 너무 추상적인 요구 ("좋은 스크래퍼 만들어줘")
- 단계별 검증 없는 전체 구현 요구

### 개발 통계
- **총 개발 시간:** 약 3시간
- **생성된 버전 수:** 7개 (최종 1개만 유지)
- **수집 필드 증가:** 21개 → 43개 (104% 향상)
- **코드 라인 수:** 496줄
- **성공률:** 95% (검색 가능한 교육과정)

## 🎯 프로젝트 목표
- KOHI 교육 사이트(edu.kohi.or.kr)의 모든 교육과정 정보를 체계적으로 수집
- 검색 결과 페이지와 상세 페이지의 모든 메타데이터 추출
- 구조화된 CSV 파일로 데이터 저장

## 📋 수집 정보 (43개 필드)

### 검색 결과 페이지에서 수집
- 썸네일 이미지 URL
- 교육비 구분 (무료/유료)
- 교육형태 (이러닝/대면/하이브리드 등)
- 교육분야 카테고리
- 모집상태 (모집중/마감)
- 지원플랫폼 (PC/Mobile)
- 맛보기 영상 유무
- 교육과정 코드

### 상세 페이지에서 수집
- 교육과정명
- 교육소개
- 신청정보 (대상, 기간, 시간, 정원 등)
- 수료기준 (학습진도, 시험, 과제 등)
- 교육구성 (과목별 상세 정보)
- 추천교육과정

## 🛠️ 기술 스택
- Python 3.x
- Playwright (브라우저 자동화)
- Pandas (데이터 처리)
- Logging (상세 로깅)

## 📦 설치 방법

### 1. Python 설치 확인
```bash
python --version
```
Python 3.8 이상이 설치되어 있어야 합니다.

### 2. 필수 패키지 설치
```bash
# 필수 패키지 설치
pip install playwright pandas

# Playwright 브라우저 설치
playwright install chromium
```

## 🚀 사용 방법

### 1. 파일 다운로드
이 레포지토리에서 다음 파일들을 다운로드:
- `kohi_scraper_ultimate.py` - 메인 스크래퍼 파일
- `work.csv` - 교육과정명 목록

### 2. 입력 파일 확인
`work.csv` 파일에 교육과정명이 첫 번째 컬럼에 있는지 확인:

```csv
교육명
"긴급복지지원 신고의무 교육"
"역량평가의 이해(사전학습)"
...
```

### 3. 스크래퍼 실행
```bash
python kohi_scraper_ultimate.py
```

### 4. 실행 중 확인사항
- 프로그램이 실행되면 자동으로 브라우저가 열립니다
- 각 교육과정마다 15-20초 정도 소요됩니다
- 10개 처리할 때마다 임시 저장됩니다

### 5. 결과 확인
실행 완료 후 생성되는 파일:
- `scraped_ultimate_final.csv` - 최종 결과 (모든 교육과정 정보)
- `scraped_ultimate_temp.csv` - 임시 저장 파일
- `scraper_ultimate.log` - 실행 로그

## 📊 출력 데이터 설명

CSV 파일의 주요 컬럼:
- **원본_교육과정명**: 검색한 교육과정명
- **스크래핑결과**: 성공/실패 여부
- **썸네일_이미지**: 교육과정 이미지 URL
- **교육비_구분**: 무료/유료
- **교육형태**: 이러닝/대면 등
- **모집상태**: 모집중/마감
- **교육과정명**: 실제 교육과정 제목
- **교육소개**: 과정 설명
- **신청_***: 신청 관련 정보들
- **수료_***: 수료기준 정보들
- **교육구성**: JSON 형식의 커리큘럼

## ⚠️ 주의사항

1. **인터넷 연결 필수**: 웹사이트 접속이 필요합니다
2. **실행 시간**: 전체 284개 과정 처리에 약 1-2시간 소요
3. **메모리 사용**: 최소 4GB RAM 권장
4. **브라우저 설치**: Chromium 브라우저가 자동 설치됩니다

## 🔧 문제 해결

### "playwright가 없습니다" 에러
```bash
pip install playwright
playwright install chromium
```

### "pandas가 없습니다" 에러
```bash
pip install pandas
```

### 실행이 안 될 때
1. Python 버전 확인 (3.8 이상)
2. 관리자 권한으로 실행
3. 바이러스 백신 일시 중지

## 📈 성능
- 평균 처리 시간: 교육과정당 약 15-20초
- 성공률: 검색 가능한 교육과정의 95% 이상
- 수집 필드: 43개

## 📞 문의
문제가 있으시면 연락주세요!

## 📄 라이선스
교육 및 연구 목적으로만 사용 가능합니다.